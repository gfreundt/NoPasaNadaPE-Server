<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Estado de Servicios | No Pasa Nada PE</title>
</head>

<body style="margin:0; padding:0; background-color:#f5f6f8; font-family:Arial, Helvetica, sans-serif; color:#111827;">
  <div style="max-width:860px; margin:0 auto; padding:28px 16px 40px;">

    <!-- HEADER -->
    <div style="text-align:center; margin-bottom:18px;">
      <div style="display:flex; justify-content:center; align-items:center; gap:14px; flex-wrap:wrap; margin-bottom:12px;">
        <img src="/static/images/logo-nopasanadape-transparente-negro.png" alt="No Pasa Nada PE" style="width:50px; height:50px;">
        <div style="width:1px; height:40px; background:#111;"></div>
        <img src="/static/images/maquinarias-icon.png" alt="Maquinarias" style="height:50px;">
      </div>

      <h1 style="margin:6px 0 2px; font-size:32px; font-weight:800;">Estado de Servicios</h1>
      <p style="margin:0 0 10px; color:#6b7280; font-size:15px;">
        Bienvenido, {{ payload.encabezado.nombre }}
      </p>

      <div style="font-size:14px; color:#374151;">
        {{ payload.encabezado.tipo_documento }} :
        <strong style="background:#e6f0fb; padding:4px 10px; border-radius:999px;">
          {{ payload.encabezado.numero_documento }}
        </strong>
        <br><br>
        <strong>PLACAS:</strong>
        {% for placa in payload.encabezado.placas %}
          <span style="display:inline-block; background:#e6f0fb; padding:4px 10px; border-radius:999px; margin:2px;">
            {{ placa }}
          </span>
        {% else %}
          <span style="color:#6b7280;">Ninguna</span>
        {% endfor %}
      </div>
    </div>

    <!-- VENCIMIENTOS -->
    <h2 style="text-align:center; font-size:20px; font-weight:800; margin:24px 0 12px;">
      Vencimientos
    </h2>

    <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse; background:#ffffff; border-radius:12px; overflow:hidden;">
      <thead>
        <tr style="background:#212529; color:#ffffff;">
          <th style="padding:12px;">Servicio</th>
          <th style="padding:12px;">Estado</th>
          <th style="padding:12px;">Vigencia</th>
          <th style="padding:12px;">Actualizado</th>
        </tr>
      </thead>
      <tbody>
        {% for row in payload.vencimientos %}
        <tr>
          <td style="padding:12px; background:{{ row.estado_bg }};">
            <strong>{{ row.titulo }}</strong><br>
            <span style="font-size:13px; color:#374151;">{{ row.subtitulo }}</span>
          </td>
          <td style="padding:12px; background:{{ row.estado_bg }}; text-align:center;">
            <strong>{{ row.estado }}</strong>
          </td>
          <td style="padding:12px; background:{{ row.estado_bg }}; text-align:center;">
            {{ row.vigencia.fecha }}<br>
            <span style="font-size:13px; color:#374151;">{{ row.vigencia.dias_restantes }}</span>
          </td>
          <td style="padding:12px; background:{{ row.estado_bg }}; text-align:center;">
            {{ row.ultima_actualizacion.fecha }}<br>
            <span style="font-size:13px; color:#374151;">
              {{ row.ultima_actualizacion.dias_desde }}
            </span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- MANTENIMIENTOS -->
    <h2 style="text-align:center; font-size:20px; font-weight:800; margin:30px 0 12px;">
      Mantenimientos
    </h2>

    {% if payload.mantenimientos %}
    <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse; background:#ffffff; border-radius:12px;">
      <thead>
        <tr style="background:#212529; color:#ffffff;">
          <th style="padding:12px;">Placa</th>
          <th style="padding:12px;">Mantenimientos</th>
          <th style="padding:12px;">Actualizado</th>
        </tr>
      </thead>
      <tbody>
        {% for row in payload.mantenimientos %}
        <tr>
          <td style="padding:12px;">
            <strong>{{ row.placa }}</strong><br>
            <span style="font-size:13px; color:#6b7280;">{{ row.subtitulo }}</span>
          </td>
          <td style="padding:12px;">
            {% if row.actividades %}
            <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse; background:#f9fafb;">
              <thead>
                <tr>
                  <th style="padding:8px; font-size:12px;">Status</th>
                  <th style="padding:8px; font-size:12px;">Kilometraje</th>
                  <th style="padding:8px; font-size:12px;">Fecha</th>
                </tr>
              </thead>
              <tbody>
                {% for act in row.actividades %}
                <tr>
                  <td style="padding:8px;">{{ act.status }}</td>
                  <td style="padding:8px;">{{ act.km }}</td>
                  <td style="padding:8px;">{{ act.fecha }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <span style="color:#6b7280;">No hay mantenimientos registrados.</span>
            {% endif %}
          </td>
          <td style="padding:12px; text-align:center;">
            {{ row.ultima_revision }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p style="text-align:center; color:#6b7280;">No hay mantenimientos registrados.</p>
    {% endif %}

    <!-- MULTAS -->
    <h2 style="text-align:center; font-size:20px; font-weight:800; margin:30px 0 12px;">
      Multas
    </h2>

    {% if payload.multas.existentes %}
    <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse; background:#ffffff; border-radius:12px;">
      <thead>
        <tr style="background:#212529; color:#ffffff;">
          <th style="padding:12px;">Servicio</th>
          <th style="padding:12px;">Fecha</th>
          <th style="padding:12px;">Falta</th>
          <th style="padding:12px;">Detalle</th>
          <th style="padding:12px;">Actualizado</th>
        </tr>
      </thead>
      <tbody>
        {% for row in payload.multas.existentes %}
        <tr>
          <td style="padding:12px;">
            <strong>{{ row.titulo }}</strong><br>
            <span style="font-size:13px;">{{ row.subtitulo }}</span>
          </td>
          <td style="padding:12px;">{{ row.fecha }}</td>
          <td style="padding:12px;">{{ row.falta }}</td>
          <td style="padding:12px;">
            <strong>{{ row.situacion.titulo }}</strong><br>
            <span style="font-size:13px;">{{ row.situacion.subtitulo }}</span>
          </td>
          <td style="padding:12px;">
            {{ row.ultima_actualizacion.fecha }}<br>
            <span style="font-size:13px;">
              {{ row.ultima_actualizacion.dias_desde }}
            </span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endif %}

    <!-- BUTTON -->
    <div style="text-align:center; margin-top:30px;">
      <a href="https://nopasanadape.com"
         target="_blank"
         style="display:inline-block; padding:14px 24px; background:#2383e2; color:#ffffff;
                text-decoration:none; font-weight:800; border-radius:12px;">
        Ir a nopasanadape.com
      </a>
    </div>

  </div>
</body>
</html>
