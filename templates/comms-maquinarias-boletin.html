<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="x-apple-disable-message-reformatting" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Estado de Servicios | No Pasa Nada PE</title>
  </head>
  <body style="margin:0; padding:0; background-color:#f5f7fb;">

    <!-- Preheader (hidden) -->
    <div style="display:none; font-size:1px; line-height:1px; max-height:0px; max-width:0px; opacity:0; overflow:hidden;">
      Estado de Servicios | No Pasa Nada PE
    </div>

    <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="background-color:#f5f7fb; width:100%;">
      <tr>
        <td align="center" style="padding:24px 12px;">
          <table role="presentation" width="700" cellspacing="0" cellpadding="0" border="0" style="width:100%; max-width:700px; background-color:#ffffff; border-radius:14px; overflow:hidden; font-family: Inter, Arial, sans-serif; font-weight:700;">
            <tr>
              <td style="padding:22px 20px 10px 20px;">

                <!-- Logos -->
                <table role="presentation" cellspacing="0" cellpadding="0" border="0" align="center" style="margin:0 auto;">
                  <tr>
                    <td align="center" valign="middle" style="padding:0 10px 0 0;">
                      <img src={{payload.metadata.imgs.logo_nopasanadape}} alt="No Pasa Nada PE Logo" width="50" height="50" style="display:block; border:0; outline:none; text-decoration:none; width:50px; height:50px;" />
                    </td>

                    <td align="center" valign="middle" style="padding:0 10px;">
                      <div style="height:40px; width:1px; background-color:#000000;"></div>
                    </td>

                    <td align="center" valign="middle" style="padding:0 0 0 10px;">
                      <img src={{payload.metadata.imgs.logo_maquinarias}} alt="Maquinarias Logo" height="50" style="display:block; border:0; outline:none; text-decoration:none; height:50px;" />
                    </td>
                  </tr>
                </table>

                <!-- Titulo y data de usuario -->
                <div style="text-align:center; margin-top:14px;">
                  <h1 style="margin:0; font-size:32px; line-height:1.15; font-weight:800; color:#111827;">Estado de Servicios</h1>
                  <div style="margin-top:6px; font-size:16px; line-height:1.35; font-weight:500; color:#6b7280;">
                    Bienvenido, {{ payload.encabezado.nombre }}
                  </div>

                  <div style="margin-top:10px; font-size:14px; line-height:1.45; font-weight:600; color:#6b7280;">
                    <span style="margin-right:6px;">{{ payload.encabezado.tipo_documento }}</span>
                    <span style="display:inline-block; padding:4px 10px; border-radius:999px; background-color:rgb(35, 131, 226); color:#ffffff; font-weight:800;">
                      {{ payload.encabezado.numero_documento }}
                    </span>

                    <span style="margin:0 10px; color:#cbd5e1;">|</span>
                    <span style="color:#111827; font-weight:800;">PLACAS</span>
                    {% for placa in payload.encabezado.placas %}
                      <span style="display:inline-block; margin-left:6px; padding:4px 10px; border-radius:999px; background-color:rgb(35, 131, 226); color:#ffffff; font-weight:800;">
                        {{ placa }}
                      </span>
                    {% else %}
                      <span style="display:inline-block; margin-left:6px; padding:4px 10px; border-radius:999px; background-color:#6b7280; color:#ffffff; font-weight:800;">
                        Ninguna
                      </span>
                    {% endfor %}
                  </div>
                </div>
              </td>
            </tr>

            <tr>
              <td style="padding:0 20px 22px 20px;">

                <!--========== VENCIMIENTOS ===========-->
                <h3 style="margin:18px 0 12px 0; text-align:center; font-size:20px; line-height:1.25; font-weight:800; color:#111827;">
                  Vencimientos
                </h3>

                <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="width:100%; border-collapse:separate; border-spacing:0 6px;">
                  <tr>
                    <th align="center" style="padding:10px 10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800; border-top-left-radius:10px;">Servicio</th>
                    <th align="center" style="padding:10px 10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Estado</th>
                    <th align="center" style="padding:10px 10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Vigencia</th>
                    <th align="center" style="padding:10px 10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800; border-top-right-radius:10px;">Actualizado</th>
                  </tr>

                  {% for row in payload.vencimientos %}
                    <tr>
                      <td valign="center" style="padding:12px 10px; background-color: {{ row.estado_bg }}; border-radius:10px 0 0 10px;">
                        <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ row.titulo }}</div>
                        {% if row.subtitulo %}
                          <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ row.subtitulo }}</div>
                        {% endif %}
                      </td>

                      <td valign="center" align="center" style="padding:12px 10px; background-color: {{ row.estado_bg }};">
                        <div style="font-size:14px; line-height:1.25; font-weight:700; color:#111827;">{{ row.estado }}</div>
                      </td>

                      <td valign="center" align="center" style="padding:12px 10px; background-color: {{ row.estado_bg }};">
                        <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ row.vigencia.fecha }}</div>
                        <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ row.vigencia.dias_restantes }}</div>
                      </td>

                      <td valign="center" align="center" style="padding:12px 10px; background-color: {{ row.estado_bg }}; border-radius:0 10px 10px 0;">
                        <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ row.ultima_actualizacion.fecha }}</div>
                        <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ row.ultima_actualizacion.dias_desde }}</div>
                      </td>
                    </tr>
                  {% endfor %}
                </table>

                <!--========== MANTENIMIENTOS ===========-->
                <h3 style="margin:26px 0 12px 0; text-align:center; font-size:20px; line-height:1.25; font-weight:800; color:#111827;">
                  Mantenimientos (DATA DE PRUEBA)
                </h3>

                {% if payload.mantenimientos %}
                  <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="width:100%; border-collapse:separate; border-spacing:0 6px;">
                    <tr>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800; width:22%; border-top-left-radius:10px;">Placa</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Mantenimientos</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800; width:22%;  border-top-right-radius:10px;">Actualizado</th>
                    </tr>

                    {% for mantenimiento in payload.mantenimientos %}
                      <tr style="background-color: {{ mantenimiento.estado_bg }}">
                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb; border-radius: 10px;">
                          <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ mantenimiento.placa }}</div>
                        </td>

                        <td valign="center" style="padding:0; border-top:1px solid #e5e7eb; ">
                          {% if mantenimiento.info %}
                            <div style="padding:10px;">
                              <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="width:100%; border-collapse:separate; border-spacing:0;">
                                <tr>
                                  <th align="center" style="padding:8px 6px; font-size:11px; letter-spacing:0.02em; text-transform:uppercase; color:#6b7280; font-weight:800; border-bottom:1px solid #e5e7eb;">Estado</th>
                                  <th align="center" style="padding:8px 6px; font-size:11px; letter-spacing:0.02em; text-transform:uppercase; color:#6b7280; font-weight:800; border-bottom:1px solid #e5e7eb;">Kilometraje</th>
                                  <th align="center" style="padding:8px 6px; font-size:11px; letter-spacing:0.02em; text-transform:uppercase; color:#6b7280; font-weight:800; border-bottom:1px solid #e5e7eb;">Fecha</th>
                                </tr>

                                {% for manto in mantenimiento.info %}
                                  <tr>
                                    <td align="center" style="padding:10px 6px; border-bottom:1px solid #f1f5f9; font-size:13px; font-weight:700; color:#111827;">
                                      {{ manto.estado }}
                                    </td>
                                    <td align="center" style="padding:10px 6px; border-bottom:1px solid #f1f5f9; font-size:13px; font-weight:700; color:#111827;">
                                      <span>{{ manto.km }}</span>
                                    </td>
                                    <td align="center" style="padding:10px 6px; border-bottom:1px solid #f1f5f9; font-size:13px; font-weight:700; color:#111827;">
                                      <span>{{ manto.vigencia.fecha }}</span>
                                    </td>
                                  </tr>
                                {% endfor %}
                              </table>
                            </div>
                          {% else %}
                            <div style="padding:14px 12px; font-size:13px; font-weight:700; color:#6b7280; text-align:center;">
                              No hay mantenimientos registrados.
                            </div>
                          {% endif %}
                        </td>

                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb; border-radius: 10px; ">
                            <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ mantenimiento.ultima_actualizacion.fecha }}</div>
                            <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ mantenimiento.ultima_actualizacion.dias_desde }}</div>
                        </td>
                      </tr>
                    {% endfor %}
                  </table>
                {% endif %}

                <!--========== MULTAS ===========-->
                <h3 style="margin:26px 0 12px 0; text-align:center; font-size:20px; line-height:1.25; font-weight:800; color:#111827;">
                  Multas
                </h3>

                {% if payload.multas.existentes %}
                  <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="width:100%; border-collapse:separate; border-spacing:0; border:1px solid #e5e7eb; border-radius:12px; overflow:hidden;">
                    <tr>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Servicio</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Fecha</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Falta</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Detalle</th>
                      <th align="center" style="padding:10px; background-color:#212529; color:#ffffff; font-size:13px; font-weight:800;">Actualizado</th>
                    </tr>

                    {% for row in payload.multas.existentes %}
                      <tr>
                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb; background-color:#f8d7da;">
                          <div style="font-size:14px; line-height:1.25; font-weight:800; color:#111827;">{{ row.titulo }}</div>
                          {% if row.subtitulo %}
                            <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ row.subtitulo }}</div>
                          {% endif %}
                        </td>

                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb;background-color:#f8d7da; font-size:13px; font-weight:700; color:#111827;">
                          {{ row.fecha }}
                        </td>

                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb; background-color:#f8d7da;">
                          <span style="font-size:13px; font-weight:900; color:#111827;">{{ row.falta }}</span>
                        </td>

                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb;background-color:#f8d7da;">
                          <div style="font-size:13px; line-height:1.25; font-weight:800; color:#111827;">
                            <span class="{{ row.detalle_class }}">{{ row.situacion.titulo }}</span>
                          </div>
                          {% if row.situacion.subtitulo %}
                            <div style="margin-top:4px; font-size:12px; line-height:1.25; font-weight:600; color:#6b7280;">{{ row.situacion.subtitulo }}</div>
                          {% endif %}
                        </td>

                        <td valign="center" align="center" style="padding:12px 10px; border-top:1px solid #e5e7eb; background-color:#f8d7da;">
                          <div style="font-size:13px; font-weight:700; color:#111827;">{{ row.ultima_actualizacion.fecha }}</div>
                          <div style="margin-top:4px; font-size:12px; font-weight:600; color:#6b7280;">{{ row.ultima_actualizacion.dias_desde }}</div>
                        </td>
                      </tr>
                    {% endfor %}
                  </table>
                {% endif %}

                {% for aviso in payload.multas.avisos %}
                  <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="width:100%; margin-top:10px; border:1px solid #e5e7eb; border-radius:12px; overflow:hidden;">
                    <tr>
                      <td align="center" style="padding:10px 12px; background-color:#d1e7dd;">
                        <div style="font-size:13px; font-weight:900; line-height:1.25;" class="{{ aviso.class }}">{{ aviso.texto }}</div>
                        <div style="margin-top:4px; font-size:11px; font-weight:600; color:#6b7280;">{{ aviso.fecha }}</div>
                      </td>
                    </tr>
                  </table>
                {% endfor %}

                <!--========== BOTON DE NAVEGACION ===========-->
                <div style="text-align:center; margin-top: 32px;">
                  <a href="{{ payload.metadata.urls.landing }}"
                     style="display:inline-block; text-decoration:none; width:100%; max-width:420px; height:52px; line-height:52px; font-size:18px; font-weight:800; border-radius:10px; background:rgb(35, 131, 226); border:1px solid rgb(35, 131, 226); color:#ffffff; box-shadow:0 2px 4px rgba(0,0,0,0.18);">
                    Visita No Pasa Nada PE
                  </a>
                </div>
              </td>
            </tr>

            <tr>
              <td style="padding:14px 20px 18px 20px; background-color:#f8fafc; text-align:center;">
                <div style="font-size:12px; line-height:1.35; font-weight:700; color:#64748b;">
                  © 2026 No Pasa Nada PE · Un servicio exclusivo para Maquinarias S.A.
                </div>
              </td>
            </tr>
          </table>

          <!-- Spacer -->
          <div style="height:18px; line-height:18px;">&nbsp;</div>
        </td>
      </tr>
    </table>
  </body>
</html>
