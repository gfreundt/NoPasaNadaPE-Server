{% extends "ui-pagina-base-maquinarias.html" %}

{% block title %}
Editar Perfil | No Pasa Nada PE 
{% endblock %}

{% block content %}
<div class="d-flex flex-column align-items-center" style="font-family: 'Inter', sans-serif; font-weight: 700;">

    <div class="d-flex justify-content-center pt-5 pb-3 align-items-center">
        <img src="/static/images/nopasanadape-icon-azul.png" alt="No Pasa Nada PE Logo" style="width: 50px; height: 50px;" class="me-2">
        <div style="height: 40px; width: 1px; background-color: black; margin-inline: 10px;"></div>
        <img src="/static/images/maquinarias-icon.png" alt="Maquinarias Logo" style="height: 50px;" class="ms-2">
    </div>

    <div class="text-center mb-4" style="max-width: 380px;">
        <h1 class="fw-bold mb-0" style="font-size: 2rem;">No Pasa Nada PE</h1>
        <h2 class="fs-4 fw-normal text-secondary mb-1">Completa tu información</h2>
    </div>
    
    <div class="notion-login w-100" style="max-width: 360px; font-weight: 400;">
        <div class="d-flex flex-column">

            <form action="" method="POST">
                
                <div class="form-group mb-3"> <label for="correo_display" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/email-icon.png" alt="Email Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Correo Electrónico
                    </label>
                    <div class="form-control" 
                          style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); background-color: #f0f0f0; display: flex; align-items: center;"
                          id="correo_display">
                        {{ usuario.correo }}
                    </div>
                    <input type="hidden" name="correo" value="{{ usuario.correo }}">
                </div>

                <div class="form-group mb-3 
                    {% if password_only %} d-none {% endif %}"> <label for="nombre-input" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/nombre-icon.png" alt="User Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Nombre y Apellido
                    </label>
                    <input id="nombre-input" 
                            name="nombre" 
                            value="{{ usuario.nombre if usuario.nombre else '' }}" 
                            class="form-control" 
                            {% if password_only %} disabled {% endif %}
                            style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">

                    {% if errors.nombre %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.nombre }}
                        </div>
                    {% endif %}
                </div>

                <div class="form-group mb-3 
                    {% if password_only %} d-none {% endif %}"> 
                    
                    <label class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/dni-icon.png" alt="Document Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Documento de Identidad
                    </label>

                    <div class="row g-2"> 
                        <div class="col-4"> <select id="tipo_documento-select" 
                                    name="tipo_documento" 
                                    class="form-select"
                                    {% if password_only %} disabled {% endif %}
                                    style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding-right: 0.5rem; padding-left: 0.5rem;">
                                
                                <option value="DNI" {% if usuario.tipo_documento == 'DNI' %} selected {% endif %}>DNI</option>
                                <option value="CE" {% if usuario.tipo_documento == 'CE' %} selected {% endif %}>CE</option>
                                <option value="Pasaporte" {% if usuario.tipo_documento == 'Pasaporte' %} selected {% endif %}>Pasaporte</option>
                            </select>
                        </div>
                        <div class="col-8"> <input id="numero_documento-input" 
                                name="numero_documento" 
                                value="{{ usuario.numero_documento if usuario.numero_documento else '' }}" 
                                class="form-control" 
                                {% if password_only %} disabled {% endif %}
                                style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        </div>
                    </div>
                
                    {% if errors.documento %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.documento }}
                        </div>
                    {% endif %}
                </div>
                <div class="form-group mb-3 
                    {% if password_only %} d-none {% endif %}"> <label for="celular-input" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/celular-icon.png" alt="Phone Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Celular
                    </label>
                    <input id="celular-input" 
                            name="celular" 
                            value="{{ usuario.celular if usuario.celular else '' }}" 
                            class="form-control" 
                            {% if password_only %} disabled {% endif %}
                            style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                    {% if errors.celular %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.celular }}
                        </div>
                    {% endif %}
                </div>

                <div class="form-group mb-3 
                    {% if password_only %} d-none {% endif %}"> <label for="placas-input" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/placa-icon.png" alt="Placas Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Placas
                    </label>
                    <input id="placas-input" 
                            name="placas" 
                            value="{{ usuario.placas if usuario.placas else '' }}" 
                            class="form-control" 
                            {% if password_only %} disabled {% endif %}
                            style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                    {% if errors.placas %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.placas }}
                        </div>
                    {% else %}
                        <div class="text-secondary small text-center mb-1" style="display: block;">
                            Ingresa hasta 3 placas separadas por comas.
                        </div>
                    {% endif %}
                </div>

                <div class="d-flex align-items-center my-3
                    {% if third_party_login %} d-none {% endif %}"> <div class="flex-grow-1 border-top border-secondary opacity-50"></div>
                    <div class="text-secondary small mx-3" style="font-weight: 400;">Contraseña</div>
                    <div class="flex-grow-1 border-top border-secondary opacity-50"></div>
                </div>

                {% if password_only %}
                    <div class="alert alert-info text-center small mb-3" role="alert" style="font-weight: 400;"> Este perfil fue creado con Google, Facebook o Microsoft. Si desea continuar con esta forma de acceso, debe generar una password.
                    </div>
                {% endif %}

                <div class="form-group mb-3
                    {% if third_party_login %} d-none {% endif %}"> <label for="password1-input" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/password-icon.png" alt="Password Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Nueva contraseña
                    </label>
                    <input id="password1-input" 
                            name="password1" 
                            type="password" class="form-control" 
                            {% if third_party_login %} disabled {% endif %}
                            style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">

                    {% if errors.password1 %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.password1 }}
                        </div>
                    {% endif %}
                </div>


                <div class="form-group mb-3
                    {% if third_party_login %} d-none {% endif %}"> <label for="password2-input" class="form-label small fw-medium text-secondary d-flex align-items-center mb-1">
                        <img src="/static/images/password-icon.png" alt="Password Icon" style="height: 22px; width: 22px; margin-right: 5px;">
                        Confirmar contraseña
                    </label>
                    <input id="password2-input" 
                            name="password2" 
                            type="password" class="form-control" 
                            {% if third_party_login %} disabled {% endif %}
                            style="height: 48px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">

                    {% if errors.password2 %}
                        <div class="invalid-feedback text-center mb-1" style="display: block;">
                            {{ errors.password2 }}
                        </div>
                    {% endif %}
                </div>

                <div class="form-check small mb-1 {% if errors.get('acepta_terminos') %} is-invalid {% endif %}">
                    <input class="form-check-input" 
                        type="checkbox" 
                        id="acepta_terminos" 
                        name="acepta_terminos"
                        {% if request.form.get('acepta_terminos') %} checked {% endif %}>
                    <label class="form-check-label text-secondary fw-medium" for="acepta_terminos"> Acepto los <a href="/terminos-y-condiciones" target="_blank">
                        Términos y Condiciones</a>
                    </label>
                </div>

                <div class="form-check small mb-3 {% if errors.get('acepta_legales') %} is-invalid {% endif %}">
                    <input class="form-check-input" 
                        type="checkbox" 
                        id="acepta_privacidad" 
                        name="acepta_privacidad"
                        {% if request.form.get('acepta_privacidad') %} checked {% endif %}>
                    <label class="form-check-label text-secondary fw-medium" for="acepta_privacidad"> Acepto la <a href="/politica-de-privacidad" target="_blank">
                        Política de Privacidad</a>
                    </label>
                    {% if errors.acepta_legales %}
                    <div class="invalid-feedback text-center mt-3 mb-1" style="display: block;">
                        {{ errors.acepta_legales }}<br>
                    </div>
                    {% endif %}
                </div>

                <button type="submit" class="btn btn-primary w-100 fw-medium mt-2 mb-1" style="height: 40px; background-color: rgb(35, 131, 226); border-color: rgb(35, 131, 226); box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);">
                    Finalizar Suscripción
                </button>
                <button type="submit" class="btn btn-primary w-100 fw-medium mt-2 mb-4" style="height: 40px; background-color: rgb(224, 39, 19); border-color: rgb(211, 93, 19); box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);">
                    Regresar
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}